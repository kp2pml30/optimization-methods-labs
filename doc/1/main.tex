\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{pgfplots}
\usepackage{graphicx}

\begin{document}

\begin{titlepage}
\centering
    {\scshape\LARGE Методы оптимизации \par}
	\vspace{1cm}
	{\scshape\Large Лабораторная работа №1\par}
    \vspace{2cm}
	{\Large\itshape     Дмитрий Проценко M3234 \par
    Кирилл Прокопенко M3236 \par
    Николай Холявин M3238\par}
	\vfill
	ИТМО y2019

	\vfill

% Bottom of the page
	{\large \today\par}
\end{titlepage}

\author{
}
\date{February 2021}

\tableofcontents
\newpage

\section{Задание}
Найти минимумы данной функции при помощи методов оптимизации:
\begin{itemize}
\item дихотомии
\item золотого сечения
\item Фиббоначи
\item парабол
\item комбинированный метод Брента
\end{itemize}

\section{Функция}
\subsection{f}
$f(x)=x^4-\frac{3}{2}arctan(x)$

\subsection{график}
\par
\begin{tikzpicture}
\begin{axis}[
	xlabel = {$x$},
	ylabel = {$f$},
	minor tick num = 2,
]
\addplot[blue, domain=-1.5:1.5] {x^4 - 3/2 * atan(rad(x))};
\end{axis}
\end{tikzpicture}

\subsection{аналитическое решение}

\begin{gather*}
f'(x) = 4x^3 - \frac{3}{2(1+x^2)} \\
f' = 0 \Leftrightarrow 8x^3(1+x^2)-3 = 0 \Leftrightarrow 8x^5+8x^3-3=0 \\
f'' = 40x^4 + 24x^2 = x^2(40x^2 + 24) \ge 0 \\
f'(0.642636) \approx 0 \\
\end{gather*}
Производная монотонно возрастает, значит этот корень является минимумом.
Данное уравнение не решается аналитически.

\section{Таблицы}

\section{Графики}
\subsection{Количество вычислений от $\varepsilon$}
{\color{red} TODO это тест графика по точкам} \par

\pgfplotstableread{epsilonToComplexity.dat}{\epsPlot}
\begin{tikzpicture}
	\begin{axis}[
	    legend style={at={(0.5,-0.1)},anchor=north},
    	xlabel = {$\varepsilon$},
    	ylabel = {$C$},
	]
	\addplot table [x={e}, y={dihotomy}] {\epsPlot};
	\addlegendentry{Дихотомия}
	\addplot table [x={e}, y={golden_ratio}] {\epsPlot};
	\addlegendentry{Золотое сечение}
	\end{axis}
\end{tikzpicture}

\section{Вывод}

\section{Многомодальные функции}
Для функций, имеющих несколько минимумов, есть шанс что метод найдет локальный минимум а не глобальный.\par

\def\FunctionF(#1){(#1)^4/2520*403-(#1)^3/60*181+(#1)^2/360*6287-(#1)/28*921+5}

\begin{tikzpicture}
\begin{axis}[
	xlabel = {$x$},
	ylabel = {$f$},
	minor tick num = 1,
]
    \addplot[blue, domain=0:10] {\FunctionF(x)};
    
    \newcommand*{\SpecialX}{4.0}
    \pgfmathsetmacro{\specialY}{\FunctionF(\SpecialX)}
    \addplot[mark=*] coordinates {(\SpecialX,\specialY)} node[pin=150:{$1$}]{} ;
    
    \renewcommand*{\SpecialX}{5.0}
    \pgfmathsetmacro{\specialY}{\FunctionF(\SpecialX)}
    \addplot[mark=*] coordinates {(\SpecialX,\specialY)} node[pin=150:{$2$}]{} ;

\end{axis}
\end{tikzpicture}
\par

Дихотомия могла посмотреть на точки вблизи $1$ и сузить интервал до $[0;4]$, пропустив глобальный максимум.
\par
{\color{red} TODO} 
Или, методы опирающиеся на несколько точек, могут посмотреть в $1$ и $2$ и получить неверное представление: функция на этом участке не монотонна, и результат не дает никакой информации.


\section{Код}
\subsection{архитектура}
Есть \code{Approximator}, который возвращает корутину, которая аппроксимирует данную функцию, на каждой итерации стягивая отрезок поиска. Данный подход позволяет иметь скорость выполнения как у нативного кода, сохраняет гарантии типов за счет c++ концептов, позволяет при необходимости использовать type-erasure и получить гибкость наследования, пожертвовав производительностью.
\subsection{ссылка}
\url{https://github.com/kp2pml30/optimization-methods-labs}

\end{document}
